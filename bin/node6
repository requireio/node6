#!/usr/bin/env node

var Promise = require('es6-promise')
var Map = require('es6-map')
var Set = require('es6-set')
var resolve = require('resolve')
var path = require('path')
var eval = require('../eval')

// hide the original initial file from node
process.argv.splice(1, 1)

// run as a REPL if no file supplied
var loadFile = process.argv[1]
if (!loadFile) {
  return require('repl').start({ eval: eval })
}

var firstChar = loadFile.charAt(0)
if (firstChar !== '.' && firstChar !== '/') {
  loadFile = './' + loadFile
}

loadFile = resolve.sync(loadFile, {
  basedir: process.cwd()
})

// Prepare the node6 override and run
// the target file
require('../')(path.dirname(loadFile))
require(loadFile)
